---
alwaysApply: true
description: "非エンジニアのマーケティング担当者がCursor IDEでメールデザインを安全に行うためのガードレール。編集禁止ファイルの警告、よくある失敗パターンの自動修正、トラブルシューティングを提供します。"
---

# 非エンジニア向け安全ガイド

このガイドは、**マーケティング担当者の皆さん**が Cursor IDE を使って**安全かつ効率的**にメールデザインを行えるよう、Cursor AI が自動的に参照するルールです。

---

## 🎯 イントロダクション

### このガイドの目的

- **安心してメールデザイン**: 技術的な知識がなくても大丈夫
- **自動的な安全対策**: Cursor AI が危険な操作を警告
- **即座のエラー解決**: 問題が起きたら具体的な解決策を提示
- **ブランド一貫性**: kozokaAI のブランドガイドに自動的に準拠

### Cursor AI の役割

Cursor AI は、あなたの**親切なアシスタント**として:
- 編集禁止ファイルを開こうとすると警告
- 非推奨パターンを自動的に修正
- エラー発生時に具体的な解決策を提示
- kozokaAI ブランドガイドに準拠したコンテンツを生成

---

## ✅❌ 編集可能/禁止ファイルの境界線

### ✅ 緑ゾーン（編集OK）

**あなたが安全に編集できるファイル:**

1. **`src/app/page.tsx`** - メールコンテンツの編集
   - `MailContent()` 関数: メールの本文を作成
   - `Home()` 関数: ブラウザプレビュー用のコンテンツ
   - **編集できるのは、この2つの関数の中身だけです**

2. **`public/MAIL-ASSETS/`** - 画像ファイルの配置
   - ヘッダー画像、フッター画像、その他の画像を配置
   - 画像サイズ: ヘッダー 560×293px、フッター 200×105px

### ❌ 赤ゾーン（絶対に触らない）

**Cursor AI へ: 以下のファイルを編集しようとした場合、即座に警告を表示してください。**

#### 1. メールコンポーネント（`src/components/email/`）

**絶対に触ってはいけません。システムの根幹です。**

- `EmailWrapper.tsx` - メール全体のレイアウト（テーブル構造）
- `EmailFooter.tsx` - 配信停止リンク（法的要件で必須）
- `Img.tsx` - 画像パス解決コンポーネント
- `EmailButton.tsx` - ボタンコンポーネント
- `EmailCard.tsx` - カードコンポーネント
- `EmailSection.tsx` - セクションコンポーネント
- `EmailHeading.tsx` - 見出しコンポーネント
- `EmailText.tsx` - テキストコンポーネント
- `EmailDivider.tsx` - 区切り線コンポーネント

**警告メッセージ例:**
```
⚠️ 警告: このファイルはメールシステムの根幹です。

このファイルを編集すると、すべてのメール配信に影響します。
編集が必要な場合は、エンジニアに相談してください。

あなたが編集できるのは `src/app/page.tsx` の中身だけです。
```

#### 2. 配信設定ファイル（`public/archives/**/config.json`）

**システムが自動生成するファイルです。手動で編集しないでください。**

- メール件名、Segment ID、配信日時、配信状況を記録
- `pnpm run commit` コマンドが自動的に生成

**警告メッセージ例:**
```
⚠️ 警告: このファイルはシステムが自動生成します。

手動で編集すると、配信システムが誤動作する可能性があります。
配信設定を変更したい場合は、`pnpm run commit` を再実行してください。
```

#### 3. 配信スクリプト（`src/scripts/`）

**配信システムの自動化スクリプトです。変更しないでください。**

- `commit.ts` - アーカイブ作成とコミット
- `validate-archive.ts` - バリデーション
- `upload-to-s3.ts` - S3 アップロード
- `send-test-email.ts` - テスト送信
- `send-production-email.ts` - 本番配信
- `production-dispatcher.ts` - 配信ディスパッチャー
- `send-scheduled-emails.ts` - 予約配信

**警告メッセージ例:**
```
⚠️ 警告: このファイルは配信システムの自動化スクリプトです。

変更すると、GitHub Actions やメール配信が正常に動作しなくなります。
エンジニアに相談してください。
```

#### 4. CI/CD ワークフロー（`.github/workflows/`）

**GitHub Actions の自動化ワークフローです。変更しないでください。**

- `check.yml` - Lint、型チェック、ビルド、バリデーション
- `staging.yml` - S3 アップロード、テストメール送信
- `production.yml` - 本番配信（Manual Approval）
- `scheduled-email-delivery.yml` - 予約配信（cron: 5分ごと）

**警告メッセージ例:**
```
⚠️ 警告: このファイルは CI/CD パイプラインの設定です。

変更すると、自動テスト、デプロイ、配信が正常に動作しなくなります。
エンジニアに相談してください。
```

#### 5. 設定ファイル

**プロジェクトの設定ファイルです。変更しないでください。**

- `package.json` - 依存関係の管理
- `pnpm-lock.yaml` - 依存関係のロック
- `.env` - 環境変数（API キー、AWS 認証情報など）
- `tsconfig.json` - TypeScript 設定
- `next.config.js` - Next.js 設定
- `postcss.config.js` - PostCSS 設定
- `tailwind.config.ts` - Tailwind CSS 設定

**警告メッセージ例:**
```
⚠️ 警告: このファイルはプロジェクトの設定ファイルです。

変更すると、ビルドやデプロイが失敗する可能性があります。
設定変更が必要な場合は、エンジニアに相談してください。
```

---

## 🚫 よくある失敗パターンと自動修正

**Cursor AI へ: 以下のパターンを検出したら、自動的に修正して理由を説明してください。**

### パターン1: Tailwind CSS クラスを使う

**問題:**
- Tailwind CSS クラス（`className="bg-white p-4"`）はメールクライアント（Outlook、Gmail）で非対応
- メールが正しく表示されない原因になります

**自動修正:**
```typescript
// ❌ 間違い（Tailwind CSSクラス）
<div className="bg-white p-4 text-center">
  コンテンツ
</div>

// ✅ 正解（インラインスタイル）
<div style={{ backgroundColor: '#ffffff', padding: '16px', textAlign: 'center' }}>
  コンテンツ
</div>
```

**Cursor AI の説明例:**
```
💡 Tailwind CSS クラスをインラインスタイルに変換しました。

理由: メールクライアント（Outlook、Gmail）は Tailwind CSS に対応していません。
インラインスタイルを使うことで、すべてのメールクライアントで正しく表示されます。
```

### パターン2: Flexbox や Grid を使う

**問題:**
- Flexbox（`display: flex`）や Grid（`display: grid`）はメールクライアントで非対応
- レイアウトが崩れる原因になります

**自動修正:**
```typescript
// ❌ 間違い（Flexbox）
<div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
  コンテンツ
</div>

// ✅ 正解（textAlign）
<div style={{ textAlign: 'center' }}>
  コンテンツ
</div>
```

**Cursor AI の説明例:**
```
💡 Flexbox を textAlign に変換しました。

理由: メールクライアントは Flexbox に対応していません。
中央揃えは textAlign: 'center' を使ってください。
```

### パターン3: EmailFooter を削除する

**問題:**
- EmailFooter には配信停止リンクが含まれます
- FTC（米国）および GDPR（欧州）の法的要件で必須
- 削除すると法律違反になります

**自動修正:**
```typescript
// ❌ 間違い（EmailFooter削除）
<EmailWrapper previewText="...">
  {/* メールコンテンツ */}
</EmailWrapper>

// ✅ 正解（EmailFooterは自動的に追加される）
<EmailWrapper previewText="...">
  {/* メールコンテンツ */}
  {/* EmailFooter は EmailWrapper 内で自動的に追加されます */}
</EmailWrapper>
```

**Cursor AI の説明例:**
```
⚠️ EmailFooter は削除できません。

理由: EmailFooter には配信停止リンクが含まれており、FTC（米国）および GDPR（欧州）の法的要件で必須です。
EmailFooter は EmailWrapper 内で自動的に追加されるため、手動で削除する必要はありません。
```

### パターン4: 画像パスを直接指定する

**問題:**
- 画像パスは開発時と本番時で異なります
- 開発時: `/MAIL-ASSETS/hero.png`
- 本番時: `https://bucket.s3.region.amazonaws.com/archives/YYYY/MM/DD-MSG/assets/hero.png`
- 直接指定すると本番環境で画像が表示されません

**自動修正:**
```typescript
// ❌ 間違い（直接指定）
<img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" />

// ✅ 正解（Imgコンポーネント）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />
```

**Cursor AI の説明例:**
```
💡 img タグを Img コンポーネントに変換しました。

理由: 画像パスは開発時と本番時で異なります。
Img コンポーネントを使うことで、本番環境でも画像が正しく表示されます。
```

### パターン5: 絵文字を使う

**問題:**
- 絵文字はブラウザ・OS によって表示が異なります
- スクリーンリーダーでの読み上げが困難（アクセシビリティ問題）
- メールクライアントによっては文字化けします

**自動修正:**
```typescript
// ❌ 間違い（絵文字使用）
<EmailHeading>🎉 サマーセール開催中！</EmailHeading>

// ✅ 正解（テキストのみ）
<EmailHeading>サマーセール開催中</EmailHeading>
```

**Cursor AI の説明例:**
```
💡 絵文字を削除しました。

理由: 絵文字はブラウザ・OS によって表示が異なり、スクリーンリーダーでの読み上げが困難です。
プロフェッショナルなメールには、絵文字を使わずテキストのみで表現してください。
```

---

## 🆘 トラブルシューティング（即座のエラー解決）

**Cursor AI へ: エラー発生時に以下の診断手順と解決策を提示してください。**

### エラー1: メールが表示されない

**症状:**
- ブラウザで `http://localhost:3000` を開いても、メールが表示されない
- 白い画面が表示される

**診断手順:**

1. **ブラウザのコンソールを確認**
   - Chrome の場合: F12 → Console タブ
   - エラーメッセージが表示されているか確認

2. **よくある原因:**
   - ✅ `src/app/page.tsx` の構文エラー（閉じタグ忘れ、カンマ忘れ）
   - ✅ `EmailWrapper` の `previewText` プロパティが未設定
   - ✅ コンポーネントのインポート漏れ

3. **解決策:**

**原因A: 構文エラー（閉じタグ忘れ）**
```typescript
// ❌ 間違い（</EmailHeading>忘れ）
<EmailHeading>サマーセール開催中

// ✅ 正解
<EmailHeading>サマーセール開催中</EmailHeading>
```

**原因B: previewText 未設定**
```typescript
// ❌ 間違い（previewTextなし）
<EmailWrapper>

// ✅ 正解
<EmailWrapper previewText="サマーセール最大50%OFF！この機会をお見逃しなく。">
```

**原因C: インポート漏れ**
```typescript
// ✅ 正解（必要なコンポーネントをすべてインポート）
import { EmailButton } from '@/components/email/EmailButton';
import { EmailCard } from '@/components/email/EmailCard';
import { EmailDivider } from '@/components/email/EmailDivider';
import { EmailHeading } from '@/components/email/EmailHeading';
import { EmailSection } from '@/components/email/EmailSection';
import { EmailText } from '@/components/email/EmailText';
import { EmailWrapper } from '@/components/email/EmailWrapper';
import { Img } from '@/components/email/Img';
```

**Cursor AI の診断例:**
```
🔍 診断結果: 構文エラーが見つかりました。

問題: 6行目で </EmailHeading> 閉じタグが不足しています。

修正前:
<EmailHeading>サマーセール開催中

修正後:
<EmailHeading>サマーセール開催中</EmailHeading>

この修正を適用しますか？
```

### エラー2: 画像が表示されない

**症状:**
- メールは表示されるが、画像が表示されない
- 画像の代わりに alt テキストが表示される

**診断手順:**

1. **画像ファイルの存在確認**
   - `public/MAIL-ASSETS/` に画像ファイルが配置されているか確認

2. **よくある原因:**
   - ✅ 画像ファイル名のタイポ（`hero.png` を `helo.png` と記述）
   - ✅ 画像パスの誤り（`/MAIL-ASSETS/` を `/ASSETS/` と記述）
   - ✅ `Img` コンポーネントではなく `<img>` タグを使用
   - ✅ `width` と `height` プロパティが未設定

3. **解決策:**

**原因A: 画像ファイル名のタイポ**
```typescript
// ❌ 間違い（helo.png → タイポ）
<Img src="/MAIL-ASSETS/helo.png" alt="ヒーロー画像" width={560} height={293} />

// ✅ 正解（hero.png）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />
```

**原因B: 画像パスの誤り**
```typescript
// ❌ 間違い（/ASSETS/ → パス誤り）
<Img src="/ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />

// ✅ 正解（/MAIL-ASSETS/）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />
```

**原因C: img タグを使用**
```typescript
// ❌ 間違い（<img>タグ）
<img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" />

// ✅ 正解（Imgコンポーネント）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />
```

**原因D: width と height が未設定**
```typescript
// ❌ 間違い（width/height なし）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" />

// ✅ 正解（width/height 必須）
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />
```

**Cursor AI の診断例:**
```
🔍 診断結果: 画像ファイル名にタイポがあります。

問題: `helo.png` というファイル名は存在しません。正しくは `hero.png` です。

修正前:
<Img src="/MAIL-ASSETS/helo.png" alt="ヒーロー画像" width={560} height={293} />

修正後:
<Img src="/MAIL-ASSETS/hero.png" alt="ヒーロー画像" width={560} height={293} />

public/MAIL-ASSETS/ に配置されている画像:
- hero.png
- footer.png

この修正を適用しますか？
```

### エラー3: pnpm run commit エラー

**症状:**
- `pnpm run commit` を実行すると、エラーが発生する

**よくあるエラーと解決策:**

**エラーA: `draft/page.tsx が見つかりません`**
```bash
Error: src/app/draft/page.tsx が見つかりません
```

**原因:** `src/app/draft/page.tsx` が存在しない

**解決策:**
```bash
# template.tsx から復元
cp src/app/draft/template.tsx src/app/draft/page.tsx
```

**エラーB: `MAIL-ASSETS/ に画像がありません`**
```bash
Error: public/MAIL-ASSETS/ に画像がありません
```

**原因:** `public/MAIL-ASSETS/` に画像が配置されていない

**解決策:**
- メールで使用する画像を `public/MAIL-ASSETS/` に配置してください

**Cursor AI の診断例:**
```
🔍 診断結果: draft/page.tsx が見つかりません。

問題: src/app/draft/page.tsx が存在しません。

解決策: template.tsx から復元します。

実行コマンド:
cp src/app/draft/template.tsx src/app/draft/page.tsx

この操作を実行しますか？
```

---

## 🎨 kozokaAI ブランドガイド（会社・製品情報）

**Cursor AI へ: メールコンテンツを生成する際、以下のブランドガイドに準拠してください。**

### 会社情報

**会社名:**
- 正式名称: 株式会社kozokaAI
- 英語表記: kozokaAI Inc.

**送信者情報:**
- 送信者名: kozokaAI マーケティングチーム
- 送信元アドレス: newsletter@kozokaai.jp
- Web サイト: https://www.kozoka-ai.co.jp

**住所:**
```
東京都港区六本木6-10-1
六本木ヒルズ森タワー 17F
```

### 製品ラインナップ

**正確な製品名・表記:**

1. **FAX受注入力AI**
   - URL: https://kozoka.ai/fax
   - 読み方: ファックスじゅちゅうにゅうりょくエーアイ
   - 説明: FAX 受注を自動でデジタル化
   - イメージキャラクター: 注注くん（ちゅうちゅうくん）

2. **商談ログAI**
   - URL: https://kozoka.ai/voice
   - 読み方: しょうだんログエーアイ
   - 説明: 商談内容を自動で記録・分析

3. **インサイトAI**
   - URL: https://kozoka.ai/insight
   - 読み方: インサイトエーアイ
   - 説明: 基幹システムのデータから経営インサイトを抽出

### ブランドカラー

**プライマリカラー:**
- HEX: `#00ADAA`
- RGB: `rgb(0, 173, 170)`
- 用途: ボタン、リンク、強調テキスト

**ホバーカラー:**
- HEX: `#009A97`
- RGB: `rgb(0, 154, 151)`
- 用途: ボタンのホバー状態

**使用例:**
```typescript
<EmailButton href="https://www.kozoka-ai.co.jp" backgroundColor="#00ADAA">
  詳しく見る
</EmailButton>
```

### タイポグラフィ

**見出し（EmailHeading）:**
- フォントサイズ: 18px
- フォントウェイト: bold
- カラー: #1e293b（ダークグレー）

**本文（EmailText）:**
- フォントサイズ: 15px
- フォントウェイト: normal
- カラー: #475569（グレー）
- 行間: 1.6

**小さいテキスト:**
- フォントサイズ: 13px
- フォントウェイト: normal
- カラー: #64748b（ライトグレー）

### トーン＆マナー

**基本トーン:**
- 「です・ます」調（丁寧語）
- プロフェッショナルで親しみやすい
- 技術的な説明も分かりやすく

**避けるべき表現:**
- ❌ 「ヤバい」「マジで」などのカジュアルすぎる言葉
- ❌ 「絶対」「必ず」などの断定的すぎる表現
- ❌ 過度な感嘆符（!!!）

**推奨される表現:**
- ✅ 「おすすめです」「ぜひご覧ください」
- ✅ 「大幅に効率化できます」「業務改善に貢献します」
- ✅ 「お気軽にお問い合わせください」

### 画像サイズ

**ヘッダー画像:**
- サイズ: 560×293px
- ファイル形式: PNG または JPG
- 配置場所: `public/MAIL-ASSETS/hero.png`

**フッター画像:**
- サイズ: 200×105px
- ファイル形式: PNG または JPG
- 配置場所: `public/MAIL-ASSETS/footer.png`

### 必須構成要素

**1. プレビューテキスト:**
- 文字数: 50〜80文字
- 内容: メールの要約、読者の興味を引く

**2. フッター署名:**
- 送信者名: kozokaAI マーケティングチーム
- Web サイト: https://www.kozoka-ai.co.jp
- 住所: 東京都港区六本木6-10-1 六本木ヒルズ森タワー 17F

**3. 法的記載:**
- 配信停止リンク（EmailFooter に自動的に含まれます）
- プライバシーポリシーへのリンク

### 配信前チェックリスト

**Cursor AI へ: メール送信前に以下を確認してください。**

- [ ] プレビューテキストが設定されている
- [ ] ブランドカラー（#00ADAA）が使用されている
- [ ] 製品名が正確に記載されている
- [ ] 「です・ます」調で記述されている
- [ ] 画像のサイズが正しい（ヘッダー: 560×293px、フッター: 200×105px）
- [ ] Tailwind CSS クラスではなく、インラインスタイルを使用している
- [ ] EmailFooter が含まれている（自動的に追加されます）
- [ ] リンク URL が正しい

---

## 🤖 Cursor AI への総合指示

### 最優先ルール

1. **編集禁止ファイルの警告**
   - `src/components/email/`、`public/archives/**/config.json`、`src/scripts/`、`.github/workflows/`、設定ファイルを編集しようとした場合、即座に警告を表示

2. **非推奨パターンの自動修正**
   - Tailwind CSS クラス → インラインスタイルに自動変換
   - Flexbox/Grid → textAlign などに自動変換
   - `<img>` タグ → `Img` コンポーネントに自動変換
   - 絵文字 → テキストのみに自動削除

3. **kozokaAI ブランドガイド準拠**
   - メールコンテンツ生成時、ブランドカラー（#00ADAA）を使用
   - 製品名を正確に記載
   - 「です・ます」調のトーンを維持

4. **ポジティブで励ますトーン**
   - エラーメッセージではなく、「学習機会」として扱う
   - 成功時に「素晴らしいメールができました！」と褒める
   - 常に具体的な解決策を提示

5. **技術用語を避けた分かりやすい説明**
   - 「構文エラー」ではなく「閉じタグ忘れ」
   - 「プロパティ」ではなく「設定項目」
   - 「レンダリング」ではなく「表示」

### トーンの例

**エラー発生時:**
```
💡 ちょっとした修正が必要です。

問題: 6行目で閉じタグが不足しています。

修正前:
<EmailHeading>サマーセール開催中

修正後:
<EmailHeading>サマーセール開催中</EmailHeading>

この修正を適用すれば、メールが正しく表示されますよ！
```

**成功時:**
```
🎉 素晴らしいメールができました！

✅ ブランドカラー（#00ADAA）を使用
✅ 製品名が正確に記載
✅ 画像サイズが正しい
✅ 配信停止リンクが含まれている

次のステップ: pnpm run commit でメールを配信準備してください。
```

---

## 📚 詳細ガイドへのリンク

### 初めてメールを作成する方

- **初心者向けガイド**: `docs/for-non-engineers/getting-started.md`
- **コンポーネントリファレンス**: `docs/for-non-engineers/component-reference.md`

### エラーが発生した方

- **よくあるエラー集**: `docs/for-non-engineers/common-errors.md`

### ブランドガイドを確認したい方

- **kozokaAI ブランドガイド**: `docs/for-non-engineers/brand-guide.md`

### 技術的な詳細を知りたい方（エンジニア向け）

- **プロジェクト全体ルール**: `.cursor/rules/general.mdc`
- **メールデザインルール**: `.cursor/rules/email-design.mdc`
- **kozokaAI メールルール**: `.cursor/rules/kozoka-email.mdc`

---

**最終更新日**: 2026-01-21
